<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Aeson_decode (bs_aeson.Aeson_decode)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../">Up</a> – <a href="../">bs_aeson</a> &#x00BB; Aeson_decode</nav><h1>Module <code>Aeson_decode</code></h1><p>Provides a set of low level combinator primitives to decode Js.Json.t data structures A decoder combinator will return the decoded value if successful, or raise a <code>DecodeError of string</code> if unsuccessful, where the string argument contains the error message. Decoders are designed to be combined to produce more complex decoders that can decode arbitrary data structures, though the emphasis for this library is for it to be <i>possible</i> to decode any given data structure, not necessarily for it to be <i>convenient</i>. For convenience you should look towards opinionated third-party libraries.</p></header><dl><dt class="spec type" id="type-decoder"><a href="#type-decoder" class="anchor"></a><code><span class="keyword">type</span> decoder('a)</code><code> = Js.Json.t <span>=&gt;</span> <span class="type-var">'a</span></code>;</dt><dd><p>The type of a decoder combinator</p></dd></dl><dl><dt class="spec exception" id="exception-DecodeError"><a href="#exception-DecodeError" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">DecodeError</span>(string)</code>;</dt></dl><dl><dt class="spec value" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span class="keyword">let</span> bool: <a href="#type-decoder">decoder</a>(bool);</code></dt><dd><p>Decodes a JSON value into a <code>bool</code></p><p><b>Returns</b> a <code>bool</code> if the JSON value is a number.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns Js.true_ *)
let _ = Js.Json.parseExn &quot;true&quot; |&gt; Decode.bool
(* returns Js.false_ *)
let _ = Js.Json.parseExn &quot;false&quot; |&gt; Decode.bool
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;123&quot; |&gt; Decode.bool
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.bool</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-float"><a href="#val-float" class="anchor"></a><code><span class="keyword">let</span> float: <a href="#type-decoder">decoder</a>(float);</code></dt><dd><p>Decodes a JSON value into a <code>float</code></p><p><b>Returns</b> a <code>float</code> if the JSON value is a number.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 1.23 *)
let _ = Js.Json.parseExn &quot;1.23&quot; |&gt; Decode.float
(* returns 23. *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.float
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;true&quot; |&gt; Decode.float
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.float</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-int"><a href="#val-int" class="anchor"></a><code><span class="keyword">let</span> int: <a href="#type-decoder">decoder</a>(int);</code></dt><dd><p>Decodes a JSON value into an <code>int</code></p><p><b>Returns</b> an <code>int</code> if the JSON value is a number.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.int
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;1.23&quot; |&gt; Decode.int
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;true&quot; |&gt; Decode.int
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.int</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-int32"><a href="#val-int32" class="anchor"></a><code><span class="keyword">let</span> int32: <a href="#type-decoder">decoder</a>(int32);</code></dt><dd><p>Decodes a JSON value into an <code>int32</code></p></dd></dl><dl><dt class="spec value" id="val-int64"><a href="#val-int64" class="anchor"></a><code><span class="keyword">let</span> int64: <a href="#type-decoder">decoder</a>(int64);</code></dt><dd><p>Decodes a JSON value into an <code>int64</code></p></dd></dl><dl><dt class="spec value" id="val-int64_of_array"><a href="#val-int64_of_array" class="anchor"></a><code><span class="keyword">let</span> int64_of_array: <a href="#type-decoder">decoder</a>(int64);</code></dt><dd><p>Decodes a JSON value into an <code>int64</code> that is stored as an array <code>high,low</code> where high is signed and low is unsigned.</p></dd></dl><dl><dt class="spec value" id="val-nativeint"><a href="#val-nativeint" class="anchor"></a><code><span class="keyword">let</span> nativeint: <a href="#type-decoder">decoder</a>(nativeint);</code></dt><dd><p>Decodes a JSON value into an <code>nativeint</code></p></dd></dl><dl><dt class="spec value" id="val-string"><a href="#val-string" class="anchor"></a><code><span class="keyword">let</span> string: <a href="#type-decoder">decoder</a>(string);</code></dt><dd><p>Decodes a JSON value into a <code>string</code></p><p><b>Returns</b> a <code>string</code> if the JSON value is a number.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns &quot;foo&quot; *)
let _ = Js.Json.parseExn &quot;\&quot;foo\&quot;&quot; |&gt; Decode.string
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;1.23&quot; |&gt; Decode.string
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.string</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-date"><a href="#val-date" class="anchor"></a><code><span class="keyword">let</span> date: <a href="#type-decoder">decoder</a>(Js_date.t);</code></dt><dt class="spec value" id="val-nullable"><a href="#val-nullable" class="anchor"></a><code><span class="keyword">let</span> nullable: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(Js.null(<span class="type-var">'a</span>));</code></dt><dd><p>Decodes a JSON value into an <code>'a Js.null</code></p><p><b>Returns</b> <code>Js.null</code> if the JSON value is <code>null</code>, or an <code>'a Js.null</code> if the given decoder succeeds,</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns (Js.Null.return 23) *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.(nullable int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;1.23&quot; |&gt; Decode.(nullable int)
(* returns Js.null *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(nullable int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-nullAs"><a href="#val-nullAs" class="anchor"></a><code><span class="keyword">let</span> nullAs: <span class="type-var">'a</span> <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt><dd><p>Returns the given value if the JSON value is <code>null</code></p><p><b>Returns</b> an <code>'a</code> if the JSON value is <code>null</code>.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;\&quot;x\&quot;&quot; |&gt; Decode.nullAs &quot;x&quot;
(* returns &quot;x&quot; *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.nullAs &quot;x&quot;
(* returns None *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.nullAs None</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-array"><a href="#val-array" class="anchor"></a><code><span class="keyword">let</span> array: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(array(<span class="type-var">'a</span>));</code></dt><dd><p>Decodes a JSON array into an <code>'a array</code> using the given decoder on each element</p><p><b>Returns</b> an <code>'a array</code> if the JSON value is a JSON array and all its elements are successfully decoded.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns [| 1; 2; 3 |] *)
let _ = Js.Json.parseExn &quot;[1, 2, 3]&quot; |&gt; Decode.(array int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;[1, 2, &quot;c&quot;]&quot; |&gt; Decode.(array int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;123&quot; |&gt; Decode.(array int)
(* returns None *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(array int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">let</span> list: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(list(<span class="type-var">'a</span>));</code></dt><dd><p>Decodes a JSON array into an <code>'a list</code> using the given decoder on each element</p><p><b>Returns</b> an <code>'a list</code> if the JSON value is a JSON array and all its elements are successfully decoded.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns [1; 2; 3] *)
let _ = Js.Json.parseExn &quot;[1, 2, 3]&quot; |&gt; Decode.(list int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;[1, 2, &quot;c&quot;]&quot; |&gt; Decode.(list int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;123&quot; |&gt; Decode.(list int)
(* returns None *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(list int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span class="keyword">let</span> pair: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>));</code></dt><dd><p>Decodes a JSON array with two elements into an <code>'a * 'b</code> tuple using the first decoder on the left element and the second decoder on the right</p><p><b>Returns</b> an <code>'a * 'b</code> if the JSON value is a JSON array of length 2 and both its elements are successfully decoded.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns (1, &quot;bar&quot;) *)
let _ = Js.Json.parseExn &quot;[1, \&quot;bar\&quot;]&quot; |&gt; Decode.(pair int string)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;[1, 2]&quot; |&gt; Decode.(pair int string)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;[1, 2, 3]&quot; |&gt; Decode.(pair int int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-tuple2"><a href="#val-tuple2" class="anchor"></a><code><span class="keyword">let</span> tuple2: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>));</code></dt><dt class="spec value" id="val-tuple3"><a href="#val-tuple3" class="anchor"></a><code><span class="keyword">let</span> tuple3: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'c</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>));</code></dt><dt class="spec value" id="val-tuple4"><a href="#val-tuple4" class="anchor"></a><code><span class="keyword">let</span> tuple4: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'c</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'d</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>));</code></dt><dt class="spec value" id="val-tuple5"><a href="#val-tuple5" class="anchor"></a><code><span class="keyword">let</span> tuple5: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'c</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'d</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'e</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>));</code></dt><dt class="spec value" id="val-tuple6"><a href="#val-tuple6" class="anchor"></a><code><span class="keyword">let</span> tuple6: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'c</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'d</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'e</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'f</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>((<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>, <span class="type-var">'d</span>, <span class="type-var">'e</span>, <span class="type-var">'f</span>));</code></dt><dt class="spec value" id="val-singleEnumerator"><a href="#val-singleEnumerator" class="anchor"></a><code><span class="keyword">let</span> singleEnumerator: <span class="type-var">'a</span> <span>=&gt;</span> Js.Json.t <span>=&gt;</span> <span class="type-var">'a</span>;</code></dt><dt class="spec value" id="val-dict"><a href="#val-dict" class="anchor"></a><code><span class="keyword">let</span> dict: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(Js.Dict.t(<span class="type-var">'a</span>));</code></dt><dd><p>Decodes a JSON object into a dict using the given decoder on each of its values</p><p><b>Returns</b> an <code>'a Js.Dict.t</code> if the JSON value is a JSON object and all its values are successfully decoded.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns (Js.Dict.fromList [(&quot;x&quot;, 23); (&quot;y&quot;, 42)]) *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: 42 } |} |&gt; Decode.(dict int)
(* raises DecodeError *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(dict int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;123&quot; |&gt; Decode.(dict int)
(* returns None *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(dict int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-field"><a href="#val-field" class="anchor"></a><code><span class="keyword">let</span> field: string <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt><dd><p>Decodes a JSON object with a specific field into the value of that field</p><p><b>Returns</b> an <code>'a</code> if the JSON value is a JSON object with the given field and a value that is successfully decoded with the given decoder.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: 42 } |} |&gt; Decode.(field &quot;x&quot; int)
(* returns 23 *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(field &quot;x&quot; int)
(* raises DecodeError *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(field &quot;y&quot; int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;123&quot; |&gt; Decode.(field &quot;x&quot; int)
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(field &quot;x&quot; int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-at"><a href="#val-at" class="anchor"></a><code><span class="keyword">let</span> at: list(string) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt><dd><p>Same as <code>field</code> but takes a top level field and a list of nested fields for decoding nested values.</p><p><b>Returns</b> an <code>'a</code> if the JSON value is a JSON object with the given field and a value that is successfully decoded with the given decoder.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: {&quot;foo&quot;: 23}, &quot;y&quot;: 42 } |} |&gt; Decode.(at [&quot;x&quot;; &quot;foo&quot;] int)
(* raises DecodeError *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: null, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(at [&quot;x&quot;; &quot;foo&quot;] int)</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-optional"><a href="#val-optional" class="anchor"></a><code><span class="keyword">let</span> optional: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(option(<span class="type-var">'a</span>));</code></dt><dd><p>Maps a decoder <code>result</code> to an option</p><p><b>Returns</b> <code>Some of 'a</code> if the given decoder is successful, <code>None</code> if it is not.</p><p>This decoder will never raise a <code>DecodeError</code>. Its purpose is to catch and transform <code>DecodeError</code>'s of a given decoder into <code>None</code>s by mapping its <code>result</code> into an <code>option</code>. This prevents a decoder error from terminating a composite decoder, and is useful to decode optional JSON object fields.</p><p>@example </p><pre><code class="ml">open Json
(* returns (Some 23) *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.(optional int)
(* returns None *)
let _ = Js.Json.parseExn 1.23 |&gt; Decode.(optional int)
(* returns None *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(optional int)
(* returns (Some 23) *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(optional (field &quot;x&quot; int))
(* returns None *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(optional (field &quot;y&quot; int))
(* returns None *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(optional (field &quot;z&quot; int))
(* returns (Some 23) *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(field &quot;x&quot; (optional int))
(* returns None *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(field &quot;y&quot; (optional int))
(* raises DecodeError *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 23, &quot;y&quot;: &quot;b&quot; } |} |&gt; Decode.(field &quot;z&quot; (optional int))</code></pre></dd></dl><dl><dt class="spec value" id="val-result"><a href="#val-result" class="anchor"></a><code><span class="keyword">let</span> result: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(Belt.Result.t(<span class="type-var">'a</span>, <span class="type-var">'b</span>));</code></dt><dt class="spec value" id="val-either"><a href="#val-either" class="anchor"></a><code><span class="keyword">let</span> either: <a href="#type-decoder">decoder</a>(<span class="type-var">'l</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'r</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(Aeson_compatibility.Either.t(<span class="type-var">'l</span>, <span class="type-var">'r</span>));</code></dt><dt class="spec value" id="val-oneOf"><a href="#val-oneOf" class="anchor"></a><code><span class="keyword">let</span> oneOf: list(<a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>)) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt><dd><p>Tries each <code>decoder</code> in order, retunring the result of the first that succeeds</p><p><b>Returns</b> an <code>'a</code> if one of the decoders succeed.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.(oneOf [int; field &quot;x&quot; int])
(* returns 42 *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 42 } |}  |&gt; Decode.(oneOf [int; field &quot;x&quot; int])
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(oneOf [int; field &quot;x&quot; int]</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-tryEither"><a href="#val-tryEither" class="anchor"></a><code><span class="keyword">let</span> tryEither: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt></dl><aside><p>Tries each <code>decoder</code> in order, returning the result of the first that succeeds</p><p><b>Returns</b> an <code>'a</code> if one of the decoders succeed.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.(tryEither int (field &quot;x&quot; int))
(* returns 42 *)
let _ = Js.Json.parseExn {| { &quot;x&quot;: 42 } |}  |&gt; Decode.(tryEither int (field &quot;x&quot; int))
(* raises DecodeError *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.(tryEither int (field &quot;x&quot; int))</code></pre></dd></dl></aside><dl><dt class="spec value" id="val-withDefault"><a href="#val-withDefault" class="anchor"></a><code><span class="keyword">let</span> withDefault: <span class="type-var">'a</span> <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>);</code></dt><dd><p>Tries each <code>decoder</code> in order, retunring the result of the first that succeeds</p><p><b>Returns</b> an <code>'a</code> if one of the decoders succeed.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 23 *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.withDefault 0 int
(* returns 0 *)
let _ = Js.Json.parseExn &quot;\&quot;x\&quot;&quot; |&gt; Decode.withDefault 0 int
(* returns 0 *)
let _ = Js.Json.parseExn &quot;null&quot; |&gt; Decode.withDefault 0 int</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">let</span> map: (<span class="type-var">'a</span> <span>=&gt;</span> <span class="type-var">'b</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>);</code></dt><dd><p>Returns a decoder that maps the result of the given decoder if successful</p><p><b>Returns</b> a <code>'b</code> if the given decoder succeeds.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">open Json
(* returns 46 *)
let _ = Js.Json.parseExn &quot;23&quot; |&gt; Decode.map (fun x -&gt; x * x) int</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-andThen"><a href="#val-andThen" class="anchor"></a><code><span class="keyword">let</span> andThen: (<span class="type-var">'a</span> <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>)) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <a href="#type-decoder">decoder</a>(<span class="type-var">'b</span>);</code></dt><dd><p>Returns a decoder that maps the result of the given decoder if successful</p><p><b>Returns</b> an <code>'a</code> if both decoders succeed.</p><dl><dt>raises [DecodeError]</dt><dd><p>if unsuccessful</p><p>@example </p><pre><code class="ml">(* Deoce a JSON tree structure *)
type 'a tree =
| Node of 'a * 'a tree list
| Leaf of 'a

let decodeTree decodeValue =
|&gt; Decode.(
    field &quot;type&quot; string
    |&gt; andThen (fun
    | &quot;node&quot; -&gt; Node (field &quot;value&quot; decodeValue) (field &quot;children&quot; (array decodeTree |&gt; map Array.to_list))
    | &quot;leaf&quot; -&gt; Leaf (field &quot;value&quot; decodeValue)
    )
  )

let json =
  {| {
    &quot;type&quot;: &quot;node&quot;,
    &quot;value&quot;: 9
    &quot;children&quot;: [{
      &quot;type&quot;: &quot;leaf&quot;,
      &quot;value&quot;: 5,
      &quot;children&quot;: [{
        &quot;type&quot;: &quot;leaf&quot;,
        &quot;value&quot;: 3
      }, {
        &quot;type&quot;: &quot;leaf&quot;,
        &quot;value&quot;: 2
      }]
    }, {
        &quot;type&quot;: &quot;leaf&quot;,
        &quot;value&quot;: 4
    }]
  } |}

let myTree =
  json
  |&gt; Js.Json.parseExn 
  |&gt; decodeTree int</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-unwrapResult"><a href="#val-unwrapResult" class="anchor"></a><code><span class="keyword">let</span> unwrapResult: Belt.Result.t(<span class="type-var">'a</span>, string) <span>=&gt;</span> <span class="type-var">'a</span>;</code></dt><dt class="spec value" id="val-wrapResult"><a href="#val-wrapResult" class="anchor"></a><code><span class="keyword">let</span> wrapResult: <a href="#type-decoder">decoder</a>(<span class="type-var">'a</span>) <span>=&gt;</span> Js.Json.t <span>=&gt;</span> Belt.Result.t(<span class="type-var">'a</span>, string);</code></dt></dl></div></body></html>